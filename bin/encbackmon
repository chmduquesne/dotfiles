#!/bin/bash

uuid=fa7aa25e-c196-413d-b300-29c88fac79e0

backup(){
    sleep 1
    notify-send -u critical "Backup starting!" "Do NOT unplug the disk"
    report=$(rsync -avz --delete --exclude-from=$HOME/.backup.exclude \
        $HOME/ /media/$uuid | tail -n 2)
    notify-send -u critical "Backup finished." "$report"
}

inotifywait --monitor --event create --format '%f' /media/ | \
    while read file; do
        case $file in
            $uuid)
                backup
                ;;
            *)
                ;;
        esac
    done
